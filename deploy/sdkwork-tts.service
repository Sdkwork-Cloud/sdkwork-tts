# SDKWork-TTS systemd Service Configuration
# For Linux production deployments

[Unit]
Description=SDKWork-TTS Server
Documentation=https://github.com/Sdkwork-Cloud/sdkwork-tts
After=network.target network-online.target
Wants=network-online.target

[Service]
Type=simple
User=tts
Group=tts

# Working directory
WorkingDirectory=/opt/sdkwork-tts

# Environment
Environment="PATH=/opt/sdkwork-tts/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
Environment="HOME=/opt/sdkwork-tts"
Environment="RUST_BACKTRACE=1"
Environment="RUST_LOG=info"

# Load environment from file (for API keys)
EnvironmentFile=-/etc/sdkwork-tts/env

# Main executable
ExecStart=/opt/sdkwork-tts/bin/sdkwork-tts server \
    --config /opt/sdkwork-tts/config/server.yaml \
    --host 0.0.0.0 \
    --port 8080

# Restart policy
Restart=always
RestartSec=5

# Timeout
TimeoutStartSec=30
TimeoutStopSec=30

# Resource limits
LimitNOFILE=65535
LimitNPROC=4096
LimitCORE=infinity

# Memory limits (adjust based on your system)
# LimitAS=4G
# LimitRSS=2G

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/sdkwork-tts/data
ReadWritePaths=/opt/sdkwork-tts/logs

# Capabilities (if needed)
# AmbientCapabilities=CAP_NET_BIND_SERVICE

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=sdkwork-tts

[Install]
WantedBy=multi-user.target
